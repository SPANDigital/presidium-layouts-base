{{/* String Validator - pure type validation logic */}}
{{/* Assumes: value exists (root validator already checked required/null) */}}

{{- $value := .value -}}
{{- $rules := .rules -}}
{{- $fieldName := .fieldName -}}
{{- $errors := slice -}}

{{/* Type check: must be string */}}
{{- if not (reflect.IsString $value) -}}
  {{- $errors = $errors | append (printf "%s must be a string" $fieldName) -}}
  {{- return (dict "valid" false "errors" $errors) -}}
{{- end -}}

{{/* Validate pattern (regex) */}}
{{- if $rules.pattern -}}
  {{- $matches := findRE $rules.pattern $value -}}
  {{- if not $matches -}}
    {{- $errors = $errors | append (printf "%s does not match required pattern" $fieldName) -}}
  {{- end -}}
{{- end -}}

{{/* Validate min_length */}}
{{- if $rules.min_length -}}
  {{- if lt (len $value) $rules.min_length -}}
    {{- $errors = $errors | append (printf "%s must be at least %d characters" $fieldName $rules.min_length) -}}
  {{- end -}}
{{- end -}}

{{/* Validate max_length */}}
{{- if $rules.max_length -}}
  {{- if gt (len $value) $rules.max_length -}}
    {{- $errors = $errors | append (printf "%s must be no more than %d characters" $fieldName $rules.max_length) -}}
  {{- end -}}
{{- end -}}

{{- return (dict "valid" (eq (len $errors) 0) "errors" $errors) -}}
