{{/*
Checks if the current page/content is from an imported content module.
Returns: dict with isImported and githubUrl
Usage: {{ $result := partial "common/is-imported" . }}
*/}}
{{- $result := dict "isImported" false "githubUrl" "" -}}
{{- with .File -}}
    {{- $filename := .Filename -}}
    {{- range $index, $element := hugo.Deps -}}
        {{- if in $filename $element.Path -}}
            {{- $result = dict "isImported" true "githubUrl" "" -}}
            {{- if strings.Contains $element.Path "github" -}}
                {{- $pathParts := split $element.Path "github" -}}
                {{- if ge (len $pathParts) 2 -}}
                    {{- $githubPart := index $pathParts 1 -}}
                    {{- $githubPart = strings.TrimPrefix ".com/" $githubPart -}}
                    {{- $githubPart = strings.TrimPrefix "/" $githubPart -}}
                    {{- $ownerRepoParts := split $githubPart "/" -}}
                    {{- if ge (len $ownerRepoParts) 2 -}}
                        {{- $owner := index $ownerRepoParts 0 -}}
                        {{- $repo := index $ownerRepoParts 1 -}}
                        {{- $ref := cond (ne $element.Version "") $element.Version "HEAD" -}}
                        {{- $relativePath := strings.TrimPrefix $element.Path $filename -}}
                        {{- $githubUrl := printf "https://github.com/%s/%s/blob/%s/%s" $owner $repo $ref $relativePath -}}
                        {{- $result = dict "isImported" true "githubUrl" $githubUrl -}}
                    {{- end -}}
                {{- end -}}
            {{- end -}}
        {{- end -}}
    {{- end -}}
{{- end -}}
{{- return $result -}}